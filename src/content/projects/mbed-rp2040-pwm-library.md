---
title: MBED_RP2040_PWM Library
summary: A hardware-based PWM library for RP2040-based boards using the Arduino-mbed
  core. It provides high-precision, non-blocking PWM signals that remain stable even
  when the main application loop is performing blocking tasks, making it ideal for
  mission-critical control applications.
slug: mbed-rp2040-pwm-library
codeUrl: https://github.com/khoih-prog/MBED_RP2040_PWM
star: 3
version: v1.0.1
lastUpdated: '2023-01-22'
rtos: mbed-os
topics:
- arduino-mbed
- duty-cycle
- hardware-pwm
- hardware-timer
- isr
- mbed
- mbed-nano
- mbed-os
- mbed-rp2040
- nano-rp2040-connect
- non-blocking
- on-the-fly
- precise
- pwm
- pwm-driver
- pwm-frequency
- raspberry-pi-pico
- raspberry-pi-pico-rp2040
- stepper-motor-control
- stepper-motor-driver
isShow: false
createdAt: '2025-12-30'
updatedAt: '2025-12-30'
---

## Overview

The MBED_RP2040_PWM library is designed to provide high-precision, hardware-based Pulse Width Modulation (PWM) for RP2040-based microcontrollers. Specifically targeting boards like the Raspberry Pi Pico and the Arduino Nano RP2040 Connect, this library leverages the underlying hardware PWM channels of the RP2040 SoC rather than relying on software-based toggling or timer interrupts. 

By utilizing hardware-based PWM, the library ensures that the generated signals are not affected by "bad-behaving" or blocking functions in the main application loop, such as WiFi connection attempts or heavy computational tasks. This makes it an essential tool for mission-critical applications where timing accuracy is paramount, such as motor control, LED dimming, and signal generation.

## Key Features

- **Hardware-Based Execution**: PWM signals are generated by the RP2040 hardware blocks, ensuring they continue to run even if the CPU is busy or blocked.
- **High Precision**: Offers significantly better accuracy than software-based PWM solutions that rely on `millis()` or `micros()`.
- **On-the-Fly Adjustments**: Users can start, stop, change frequency, and restore PWM settings dynamically during runtime.
- **Multi-Channel Support**: Enables independent control of multiple PWM outputs with different frequencies and duty cycles.
- **Cross-Platform API**: Part of a larger family of FastPWM libraries, allowing for easier code porting between different architectures like ESP32, AVR, SAMD, and STM32.

## Technical Implementation

The library is built to work with the `ArduinoCore-mbed` (mbed_rp2040 or mbed_nano) core. It abstracts the complexity of the RP2040's hardware PWM registers into a simple, Arduino-friendly API. One unique aspect of this library is its header-only implementation style, which helps in managing linker errors in multi-file projects. Users can include `MBED_RP2040_PWM.hpp` in multiple files while including the main `.h` file in only one location to avoid "multiple definition" errors.

## Supported Hardware

This library is compatible with any board using the RP2040 microcontroller and the Arduino-mbed core, including:
- Raspberry Pi Pico
- Arduino Nano RP2040 Connect
- Adafruit Feather RP2040
- Generic RP2040 boards

## Getting Started

Setting up a PWM signal is straightforward. After defining the pin, frequency, and duty cycle, you can initialize the PWM output using the `setPWM` function. The library also provides utility functions to read back the actual parameters being used by the hardware.

```cpp
// Example: Setting up a 5kHz PWM on GP15 with 50% duty cycle
uint32_t myPin  = 15;    // GP15
float dutyCycle = 50.0f;
float freq      = 5000.0f;
mbed::PwmOut* pwm = NULL;

void setup() {
  setPWM(pwm, myPin, freq, dutyCycle);
}

void loop() {
  if (pwm) {
    // Read actual parameters
    float actualFreq = getFreq(pwm);
    float actualDuty = getDutyCycle(pwm);
  }
}
```

## Advanced Usage: Stepper Control

One of the more advanced applications demonstrated in the library is stepper motor control. By using high-frequency hardware PWM, developers can drive stepper motor drivers with smooth, precise step pulses that are immune to software jitter, which is a common issue when trying to step motors using standard software loops.
