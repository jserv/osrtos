---
title: ST7735 Video Playback for STM32
summary: A high-performance library for smooth video playback on ST7735 displays using
  STM32 microcontrollers and SD cards. It achieves 33-35 FPS by leveraging DMA for
  both SD card data retrieval and display transmission, utilizing a custom binary
  video format.
slug: st7735-video-playback-for-stm32
codeUrl: https://github.com/cmd05/ST7735-VideoPlayback-STM32
star: 16
lastUpdated: '2025-07-24'
rtos: ''
libraries:
- lvgl
topics:
- dma
- embedded-systems
- hal
- lcd
- lcd-display
- sdcard
- st7735
- stm32
- stm32f4
- tft-display
- video
- video-playback
- video-processing
isShow: false
createdAt: '2026-01-12'
updatedAt: '2026-01-12'
---

## High-Speed Video Playback on STM32

Achieving smooth video playback on resource-constrained microcontrollers like the STM32F4 series requires careful optimization of data throughput and peripheral management. The ST7735-VideoPlayback-STM32 project provides a robust solution for streaming video from an SD card to an ST7735-based display at impressive frame rates of 33-35 FPS.

By combining efficient SPI communication, Direct Memory Access (DMA), and a specialized binary video format, this library overcomes the typical bottlenecks associated with reading large amounts of data from external storage and pushing it to a display controller.

## Technical Implementation and Optimizations

The core of the project's performance lies in its use of DMA for both the SD card (TX/RX) and the ST7735 display (TX). This allows the CPU to handle file system overhead and frame synchronization while the hardware peripherals manage the heavy lifting of data transfer. 

Key technical optimizations include:
- **Modified FATFS Drivers**: The project uses modified FATFS User SPI drivers that support multi-byte SPI Transmit/Receive, significantly reducing the overhead of standard single-byte transfers.
- **DMA Pipelining**: By using DMA for display updates, the system can achieve a frame draw time of approximately 8ms, while frame reading from the SD card takes roughly 22ms.
- **High-Speed SPI**: The SD card interface is tuned with specific prescalers (using `FCLK_FAST`) to maximize read speeds without sacrificing stability.

## Custom Video Format

To minimize processing overhead on the microcontroller, the project uses a custom binary format generated by a companion Python script. This format avoids the need for complex on-the-fly decoding (like MJPEG or H.264) by storing pixel data in a layout that the ST7735 can consume directly.

### Binary Structure

The video file (`video.bin`) consists of a simple header followed by raw frame data:

**Header:**
- Video Width (2 bytes)
- Video Height (2 bytes)
- Number of Frames (2 bytes)

**Per Frame:**
- Magic bytes: `['F']['R']['M']`
- Pixel Data: Raw RGB565 color data (2 bytes per pixel)

## Hardware Configuration

The project is designed for the STM32F401RE (Nucleo-F401RE) but can be adapted to other STM32 chips. It utilizes two separate SPI buses to prevent bus contention between the storage and the display:

- **SPI1**: Dedicated to the ST7735 Display (SCK, MOSI).
- **SPI2**: Dedicated to the SD Card Module (SCK, MISO, MOSI).

Control pins such as Data/Command (DC), Reset, and Chip Select (CS) are mapped to standard GPIOs, with pull-up resistors recommended for SD card stability.

## Video Conversion Workflow

Before playback, source videos must be processed using the provided Python script located in `video_converter/video_converter.py`. This script leverages logic from LVGL's image converter to transform standard video files into the optimized RGB565 binary format. Users can specify start/end times and toggle landscape mode via command-line arguments:

```python
python video_converter.py --start 00:10 --end 00:20 --landscape input_video.mp4
```

This workflow ensures that the embedded system only handles data it is fast enough to process, shifting the computational burden of transcoding to a host PC.
